<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Broadcasting • rray</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Broadcasting">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">rray</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/broadcasting.html">Broadcasting</a>
    </li>
    <li>
      <a href="../articles/the-rray.html">The `rray`</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/DavisVaughan/rray">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Broadcasting</h1>
                        <h4 class="author">Davis Vaughan</h4>
            
            <h4 class="date">2019-05-23</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/DavisVaughan/rray/blob/master/vignettes/broadcasting.Rmd"><code>vignettes/broadcasting.Rmd</code></a></small>
      <div class="hidden name"><code>broadcasting.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(rray)</a></code></pre></div>
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>rray provides <em>broadcasting</em> semantics throughout the entire package. Broadcasting is the concept of recycling dimensions of one object to match the dimensions of another, so that some operation can be applied between the two inputs. It sounds complicated, but it really boils down to a few rules that can be applied to understand any broadcasting operation.</p>
</div>
<div id="motivation" class="section level2">
<h2 class="hasAnchor">
<a href="#motivation" class="anchor"></a>Motivation</h2>
<p>Before the rules are introduced, consider what happens when matrices of different dimensions are added together in base R.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1">x &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/matrix">matrix</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>,  <span class="dt">nrow =</span> <span class="dv">3</span>, <span class="dt">ncol =</span> <span class="dv">2</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb2-2" data-line-number="2">y &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/matrix">matrix</a></span>(1L,   <span class="dt">nrow =</span> <span class="dv">3</span>, <span class="dt">ncol =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb2-3" data-line-number="3"></a>
<a class="sourceLine" id="cb2-4" data-line-number="4">x</a>
<a class="sourceLine" id="cb2-5" data-line-number="5"><span class="co">#&gt;      [,1] [,2]</span></a>
<a class="sourceLine" id="cb2-6" data-line-number="6"><span class="co">#&gt; [1,]    1    2</span></a>
<a class="sourceLine" id="cb2-7" data-line-number="7"><span class="co">#&gt; [2,]    1    2</span></a>
<a class="sourceLine" id="cb2-8" data-line-number="8"><span class="co">#&gt; [3,]    1    2</span></a>
<a class="sourceLine" id="cb2-9" data-line-number="9"></a>
<a class="sourceLine" id="cb2-10" data-line-number="10">y</a>
<a class="sourceLine" id="cb2-11" data-line-number="11"><span class="co">#&gt;      [,1]</span></a>
<a class="sourceLine" id="cb2-12" data-line-number="12"><span class="co">#&gt; [1,]    1</span></a>
<a class="sourceLine" id="cb2-13" data-line-number="13"><span class="co">#&gt; [2,]    1</span></a>
<a class="sourceLine" id="cb2-14" data-line-number="14"><span class="co">#&gt; [3,]    1</span></a>
<a class="sourceLine" id="cb2-15" data-line-number="15"></a>
<a class="sourceLine" id="cb2-16" data-line-number="16">x <span class="op">+</span><span class="st"> </span>y</a>
<a class="sourceLine" id="cb2-17" data-line-number="17"><span class="co">#&gt; Error in x + y: non-conformable arrays</span></a></code></pre></div>
<p>If <em>any</em> of the dimensions don’t match, then an error is thrown. This behavior is actually the original motivation for the rray package. I believe that there is an intuitve result to this operation, which looks like this:</p>
<pre><code>#&gt;      [,1] [,2]
#&gt; [1,]    2    3
#&gt; [2,]    2    3
#&gt; [3,]    2    3</code></pre>
<p>The mental model to understand how this works is to alter the dimensions of <code>y</code> to match the dimensions of <code>x</code> by duplicating the columns. This is known as <em>broadcasting y</em>. After this alteration is done, then the addition is performed.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">y_broadcast &lt;-<span class="st"> </span><span class="kw"><a href="../reference/rray_broadcast.html">rray_broadcast</a></span>(y, <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">3</span>, <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb4-2" data-line-number="2"></a>
<a class="sourceLine" id="cb4-3" data-line-number="3">y_broadcast</a>
<a class="sourceLine" id="cb4-4" data-line-number="4"><span class="co">#&gt;      [,1] [,2]</span></a>
<a class="sourceLine" id="cb4-5" data-line-number="5"><span class="co">#&gt; [1,]    1    1</span></a>
<a class="sourceLine" id="cb4-6" data-line-number="6"><span class="co">#&gt; [2,]    1    1</span></a>
<a class="sourceLine" id="cb4-7" data-line-number="7"><span class="co">#&gt; [3,]    1    1</span></a>
<a class="sourceLine" id="cb4-8" data-line-number="8"></a>
<a class="sourceLine" id="cb4-9" data-line-number="9">x <span class="op">+</span><span class="st"> </span>y_broadcast</a>
<a class="sourceLine" id="cb4-10" data-line-number="10"><span class="co">#&gt;      [,1] [,2]</span></a>
<a class="sourceLine" id="cb4-11" data-line-number="11"><span class="co">#&gt; [1,]    2    3</span></a>
<a class="sourceLine" id="cb4-12" data-line-number="12"><span class="co">#&gt; [2,]    2    3</span></a>
<a class="sourceLine" id="cb4-13" data-line-number="13"><span class="co">#&gt; [3,]    2    3</span></a></code></pre></div>
<p>But how did we know (programmatically) how to alter <code>y</code> to match the dimensions of <code>x</code> here? That is where the broadcasting rules come in.</p>
</div>
<div id="rules" class="section level2">
<h2 class="hasAnchor">
<a href="#rules" class="anchor"></a>Rules</h2>
<p><strong>Broadcasting operations happen in three steps:</strong></p>
<ol style="list-style-type: decimal">
<li>Find a set of common dimensions among the inputs.</li>
<li>Broadcast each input to the common dimensions.</li>
<li>Perform the operation on the broadcast inputs.</li>
</ol>
<p>Steps 2 and 3 are relatively straightforward. For step 3, all of the inputs will have the same dimensions in the end, so the operation can be done in the same was as base R would do originally. For step 2, altering a dimension using broadcasting just means to repeat the dimension as many times as necessary. In the previous example, I claimed that <code>y</code> need to be broadcasted from a <code>(3, 1)</code> matrix to <code>(3, 2)</code>. This just meant duplicating the existing column so there are two of them.</p>
<p>The real engine of broadcasting revolves around step 1, finding common dimensions among the inputs. To find this set of common dimensions, each individual dimension of <code>x</code> and <code>y</code> are compared against one another (rows are compared to rows, columns to columns, etc). In each comparison, a set of rules are applied to generate the common dimension. Ones all of the dimensions are compared, the resulting set of dimensions is the shape that <code>x</code> and <code>y</code> are both broadcast to in step 2, and is the shape of the result obtained from the operation in step 3. Below are the rules used when comparing individual dimensions.</p>
<p><strong>The rules of broadcasting:</strong></p>
<ol style="list-style-type: decimal">
<li><p>If a dimension is implicit, it should be appended to the right hand side as a <code>1</code>.</p></li>
<li><p>If the dimensions are the same, that is the common dimension.</p></li>
<li><p>If the dimensions are different, and one is <code>1</code>, then that input can validly be recycled, so the larger dimension is used.</p></li>
<li><p>If the dimensions are different, and neither is <code>1</code>, throw an error.</p></li>
</ol>
<p>These three rules also happen to match the “tidy” recycling rules. I also believe that these rules are fully <em>shape-stable</em>, meaning that you can exactly predict the shape of the output from the shapes of the inputs. I think this is an important idea for creating intuitive software.</p>
</div>
<div id="example---x-y" class="section level2">
<h2 class="hasAnchor">
<a href="#example---x-y" class="anchor"></a>Example - <code>x + y</code>
</h2>
<p>Let’s revisit the original example, but use the broadcasting rules to understand how to get the result.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">x</a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="co">#&gt;      [,1] [,2]</span></a>
<a class="sourceLine" id="cb5-3" data-line-number="3"><span class="co">#&gt; [1,]    1    2</span></a>
<a class="sourceLine" id="cb5-4" data-line-number="4"><span class="co">#&gt; [2,]    1    2</span></a>
<a class="sourceLine" id="cb5-5" data-line-number="5"><span class="co">#&gt; [3,]    1    2</span></a>
<a class="sourceLine" id="cb5-6" data-line-number="6"></a>
<a class="sourceLine" id="cb5-7" data-line-number="7">y</a>
<a class="sourceLine" id="cb5-8" data-line-number="8"><span class="co">#&gt;      [,1]</span></a>
<a class="sourceLine" id="cb5-9" data-line-number="9"><span class="co">#&gt; [1,]    1</span></a>
<a class="sourceLine" id="cb5-10" data-line-number="10"><span class="co">#&gt; [2,]    1</span></a>
<a class="sourceLine" id="cb5-11" data-line-number="11"><span class="co">#&gt; [3,]    1</span></a></code></pre></div>
<p>When adding these two matrices together, it’s useful to write out the dimensions explicitly, using the general notation of:</p>
<pre><code>(rows, cols) | object_name</code></pre>
<pre><code>(3, 2) | x
(3, 1) | y
-------|-------
(3, 2) | common</code></pre>
<p>To understand how we get from <code>x + y -&gt; result</code>, compare dimensions vertically (one at a time), and apply the broadcasting rules.</p>
<ul>
<li>
<p>1st dimension:</p>
<ul>
<li>
<code>x</code> has <code>3</code> rows</li>
<li>
<code>y</code> has <code>3</code> rows.</li>
<li>Rule 2, the common dimension is <code>3</code>.</li>
</ul>
</li>
<li>
<p>2nd dimension:</p>
<ul>
<li>
<code>x</code> has <code>2</code> columns</li>
<li>
<code>y</code> has <code>1</code> column</li>
<li>Rule 3, use the larger dimension, <code>2</code>.</li>
</ul>
</li>
</ul>
<p>The common dimensions have now been determined, <code>(3, 2)</code>. At this point, the other broadcasting steps are applied:</p>
<ul>
<li>Broadcast <code>x</code> to <code>(3, 2)</code>. Nothing to do here.</li>
<li>Broadcast <code>y</code> to <code>(3, 2)</code>. Originally, <code>y</code> was <code>(3, 1)</code>. To broadcast to <code>(3, 2)</code>, duplicate the 2nd dimension (the column) of <code>y</code>.</li>
<li>Now, <code>x</code> and <code>y</code> are <code>(3, 2)</code>. Add them!</li>
</ul>
<p>rray applies these rules automatically when an <code>rray</code> object is used.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">x_rray &lt;-<span class="st"> </span><span class="kw"><a href="../reference/as_rray.html">as_rray</a></span>(x)</a>
<a class="sourceLine" id="cb8-2" data-line-number="2"></a>
<a class="sourceLine" id="cb8-3" data-line-number="3">x_rray</a>
<a class="sourceLine" id="cb8-4" data-line-number="4"><span class="co">#&gt; &lt;rray&lt;int&gt;[,2][6]&gt;</span></a>
<a class="sourceLine" id="cb8-5" data-line-number="5"><span class="co">#&gt;      [,1] [,2]</span></a>
<a class="sourceLine" id="cb8-6" data-line-number="6"><span class="co">#&gt; [1,]    1    2</span></a>
<a class="sourceLine" id="cb8-7" data-line-number="7"><span class="co">#&gt; [2,]    1    2</span></a>
<a class="sourceLine" id="cb8-8" data-line-number="8"><span class="co">#&gt; [3,]    1    2</span></a>
<a class="sourceLine" id="cb8-9" data-line-number="9"></a>
<a class="sourceLine" id="cb8-10" data-line-number="10">x_rray <span class="op">+</span><span class="st"> </span>y</a>
<a class="sourceLine" id="cb8-11" data-line-number="11"><span class="co">#&gt; &lt;rray&lt;int&gt;[,2][6]&gt;</span></a>
<a class="sourceLine" id="cb8-12" data-line-number="12"><span class="co">#&gt;      [,1] [,2]</span></a>
<a class="sourceLine" id="cb8-13" data-line-number="13"><span class="co">#&gt; [1,]    2    3</span></a>
<a class="sourceLine" id="cb8-14" data-line-number="14"><span class="co">#&gt; [2,]    2    3</span></a>
<a class="sourceLine" id="cb8-15" data-line-number="15"><span class="co">#&gt; [3,]    2    3</span></a></code></pre></div>
</div>
<div id="example---implicit-dimensions" class="section level2">
<h2 class="hasAnchor">
<a href="#example---implicit-dimensions" class="anchor"></a>Example - Implicit Dimensions</h2>
<p>If <code>y</code> was a vector of <code>1</code>s, not a matrix, what would have changed?</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">x_rray</a>
<a class="sourceLine" id="cb9-2" data-line-number="2"><span class="co">#&gt; &lt;rray&lt;int&gt;[,2][6]&gt;</span></a>
<a class="sourceLine" id="cb9-3" data-line-number="3"><span class="co">#&gt;      [,1] [,2]</span></a>
<a class="sourceLine" id="cb9-4" data-line-number="4"><span class="co">#&gt; [1,]    1    2</span></a>
<a class="sourceLine" id="cb9-5" data-line-number="5"><span class="co">#&gt; [2,]    1    2</span></a>
<a class="sourceLine" id="cb9-6" data-line-number="6"><span class="co">#&gt; [3,]    1    2</span></a>
<a class="sourceLine" id="cb9-7" data-line-number="7"></a>
<a class="sourceLine" id="cb9-8" data-line-number="8">z &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/vector">as.vector</a></span>(y)</a>
<a class="sourceLine" id="cb9-9" data-line-number="9">z</a>
<a class="sourceLine" id="cb9-10" data-line-number="10"><span class="co">#&gt; [1] 1 1 1</span></a>
<a class="sourceLine" id="cb9-11" data-line-number="11"></a>
<a class="sourceLine" id="cb9-12" data-line-number="12">x_rray <span class="op">+</span><span class="st"> </span>z</a>
<a class="sourceLine" id="cb9-13" data-line-number="13"><span class="co">#&gt; &lt;rray&lt;int&gt;[,2][6]&gt;</span></a>
<a class="sourceLine" id="cb9-14" data-line-number="14"><span class="co">#&gt;      [,1] [,2]</span></a>
<a class="sourceLine" id="cb9-15" data-line-number="15"><span class="co">#&gt; [1,]    2    3</span></a>
<a class="sourceLine" id="cb9-16" data-line-number="16"><span class="co">#&gt; [2,]    2    3</span></a>
<a class="sourceLine" id="cb9-17" data-line-number="17"><span class="co">#&gt; [3,]    2    3</span></a></code></pre></div>
<p>This operation is still valid, and represents an important broadcasting idea because it allows lower dimensional objects (1D) to be combined with higher dimensional objects (2D) in a formalized way. To start, write out the dimensions:</p>
<pre><code>(3, 2) | x
(3)    | z</code></pre>
<p>To find the common dimensions, Rule 1 is first applied because there are “implicit” dimensions. <code>z</code> has the 1st dimension (the rows), but is missing the 2nd dimension (the columns). When this occurs, add <code>1</code>s to the right hand side until the dimensionalities match.</p>
<pre><code>(3, 2) | x
(3, 1) | z</code></pre>
<p>Now, apply broadcasting rules as usual.</p>
<ul>
<li>
<p>1st dimension:</p>
<ul>
<li>
<code>x</code> has <code>3</code> rows.</li>
<li>
<code>z</code> has <code>3</code> rows.</li>
<li>Rule 2, the common dimension is <code>3</code>.</li>
</ul>
</li>
<li>
<p>2nd dimension:</p>
<ul>
<li>
<code>x</code> has <code>2</code> columns</li>
<li>
<code>y</code> has <code>1</code> column</li>
<li>Rule 3, use the larger dimension, <code>2</code>.</li>
</ul>
</li>
</ul>
<p>The common dimensions are <code>(3, 2)</code>. <code>x</code> already has these dimensions, so nothing need to be done to it. <code>z</code> only has the dimensions <code>(3)</code>, so clearly something needs to change there. To see what <code>rray</code> will do when broadcasting an object to a new set of dimensions, use <code><a href="../reference/rray_broadcast.html">rray_broadcast()</a></code>. In this case, the vector of <code>1</code>s first became a one column matrix when the implicit dimension was added, and then that column was repeated to match the common dimensions. At that point, the result could be added to <code>x</code>.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1">z</a>
<a class="sourceLine" id="cb12-2" data-line-number="2"><span class="co">#&gt; [1] 1 1 1</span></a>
<a class="sourceLine" id="cb12-3" data-line-number="3"></a>
<a class="sourceLine" id="cb12-4" data-line-number="4"><span class="kw"><a href="../reference/rray_broadcast.html">rray_broadcast</a></span>(z, <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">3</span>, <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb12-5" data-line-number="5"><span class="co">#&gt;      [,1]</span></a>
<a class="sourceLine" id="cb12-6" data-line-number="6"><span class="co">#&gt; [1,]    1</span></a>
<a class="sourceLine" id="cb12-7" data-line-number="7"><span class="co">#&gt; [2,]    1</span></a>
<a class="sourceLine" id="cb12-8" data-line-number="8"><span class="co">#&gt; [3,]    1</span></a>
<a class="sourceLine" id="cb12-9" data-line-number="9"></a>
<a class="sourceLine" id="cb12-10" data-line-number="10"><span class="kw"><a href="../reference/rray_broadcast.html">rray_broadcast</a></span>(z, <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">3</span>, <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb12-11" data-line-number="11"><span class="co">#&gt;      [,1] [,2]</span></a>
<a class="sourceLine" id="cb12-12" data-line-number="12"><span class="co">#&gt; [1,]    1    1</span></a>
<a class="sourceLine" id="cb12-13" data-line-number="13"><span class="co">#&gt; [2,]    1    1</span></a>
<a class="sourceLine" id="cb12-14" data-line-number="14"><span class="co">#&gt; [3,]    1    1</span></a></code></pre></div>
</div>
<div id="example---higher-dimensions" class="section level2">
<h2 class="hasAnchor">
<a href="#example---higher-dimensions" class="anchor"></a>Example - Higher Dimensions</h2>
<p>Broadcasting get’s more interesting when higher dimensional objects are used. Additionally, at this point only 1 dimension has been changing (the columns), and only 1 object at a time needed altering. This example will require both inputs to be changed.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1">a &lt;-<span class="st"> </span><span class="kw"><a href="../reference/rray.html">rray</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>, <span class="dv">3</span>))</a>
<a class="sourceLine" id="cb13-2" data-line-number="2">a</a>
<a class="sourceLine" id="cb13-3" data-line-number="3"><span class="co">#&gt; &lt;rray&lt;int&gt;[,3][3]&gt;</span></a>
<a class="sourceLine" id="cb13-4" data-line-number="4"><span class="co">#&gt;      [,1] [,2] [,3]</span></a>
<a class="sourceLine" id="cb13-5" data-line-number="5"><span class="co">#&gt; [1,]    1    2    3</span></a>
<a class="sourceLine" id="cb13-6" data-line-number="6"></a>
<a class="sourceLine" id="cb13-7" data-line-number="7">b &lt;-<span class="st"> </span><span class="kw"><a href="../reference/rray.html">rray</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">8</span>, <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb13-8" data-line-number="8">b</a>
<a class="sourceLine" id="cb13-9" data-line-number="9"><span class="co">#&gt; &lt;rray&lt;int&gt;[,1,2][8]&gt;</span></a>
<a class="sourceLine" id="cb13-10" data-line-number="10"><span class="co">#&gt; , , 1</span></a>
<a class="sourceLine" id="cb13-11" data-line-number="11"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb13-12" data-line-number="12"><span class="co">#&gt;      [,1]</span></a>
<a class="sourceLine" id="cb13-13" data-line-number="13"><span class="co">#&gt; [1,]    1</span></a>
<a class="sourceLine" id="cb13-14" data-line-number="14"><span class="co">#&gt; [2,]    2</span></a>
<a class="sourceLine" id="cb13-15" data-line-number="15"><span class="co">#&gt; [3,]    3</span></a>
<a class="sourceLine" id="cb13-16" data-line-number="16"><span class="co">#&gt; [4,]    4</span></a>
<a class="sourceLine" id="cb13-17" data-line-number="17"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb13-18" data-line-number="18"><span class="co">#&gt; , , 2</span></a>
<a class="sourceLine" id="cb13-19" data-line-number="19"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb13-20" data-line-number="20"><span class="co">#&gt;      [,1]</span></a>
<a class="sourceLine" id="cb13-21" data-line-number="21"><span class="co">#&gt; [1,]    5</span></a>
<a class="sourceLine" id="cb13-22" data-line-number="22"><span class="co">#&gt; [2,]    6</span></a>
<a class="sourceLine" id="cb13-23" data-line-number="23"><span class="co">#&gt; [3,]    7</span></a>
<a class="sourceLine" id="cb13-24" data-line-number="24"><span class="co">#&gt; [4,]    8</span></a></code></pre></div>
<p>Perhaps surprisingly, these inputs can be added together using broadcasting.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1">a <span class="op">+</span><span class="st"> </span>b</a>
<a class="sourceLine" id="cb14-2" data-line-number="2"><span class="co">#&gt; &lt;rray&lt;int&gt;[,3,2][24]&gt;</span></a>
<a class="sourceLine" id="cb14-3" data-line-number="3"><span class="co">#&gt; , , 1</span></a>
<a class="sourceLine" id="cb14-4" data-line-number="4"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb14-5" data-line-number="5"><span class="co">#&gt;      [,1] [,2] [,3]</span></a>
<a class="sourceLine" id="cb14-6" data-line-number="6"><span class="co">#&gt; [1,]    2    3    4</span></a>
<a class="sourceLine" id="cb14-7" data-line-number="7"><span class="co">#&gt; [2,]    3    4    5</span></a>
<a class="sourceLine" id="cb14-8" data-line-number="8"><span class="co">#&gt; [3,]    4    5    6</span></a>
<a class="sourceLine" id="cb14-9" data-line-number="9"><span class="co">#&gt; [4,]    5    6    7</span></a>
<a class="sourceLine" id="cb14-10" data-line-number="10"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb14-11" data-line-number="11"><span class="co">#&gt; , , 2</span></a>
<a class="sourceLine" id="cb14-12" data-line-number="12"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb14-13" data-line-number="13"><span class="co">#&gt;      [,1] [,2] [,3]</span></a>
<a class="sourceLine" id="cb14-14" data-line-number="14"><span class="co">#&gt; [1,]    6    7    8</span></a>
<a class="sourceLine" id="cb14-15" data-line-number="15"><span class="co">#&gt; [2,]    7    8    9</span></a>
<a class="sourceLine" id="cb14-16" data-line-number="16"><span class="co">#&gt; [3,]    8    9   10</span></a>
<a class="sourceLine" id="cb14-17" data-line-number="17"><span class="co">#&gt; [4,]    9   10   11</span></a></code></pre></div>
<p>To understand this, write out dimensions and follow the rules, as usual.</p>
<pre><code>(1, 3)    | a
(4, 1, 2) | b</code></pre>
<p>Implicit dimensions are present for <code>a</code>, so make them explicit with <code>1</code>s using Rule 1.</p>
<pre><code>(1, 3, 1) | a
(4, 1, 2) | b</code></pre>
<ul>
<li>
<p>1st dimension:</p>
<ul>
<li>
<code>a</code> has <code>1</code> rows.</li>
<li>
<code>b</code> has <code>4</code> rows.</li>
<li>Rule 3, use the larger dimension, <code>4</code>.</li>
</ul>
</li>
<li>
<p>2nd dimension:</p>
<ul>
<li>
<code>a</code> has <code>3</code> columns.</li>
<li>
<code>b</code> has <code>1</code> column.</li>
<li>Rule 3, use the larger dimension, <code>3</code>.</li>
</ul>
</li>
<li>
<p>3rd dimension:</p>
<ul>
<li>
<code>a</code> has <code>1</code> element in the 3rd dimension.</li>
<li>
<code>b</code> has <code>2</code> element in the 3rd dimension.</li>
<li>Rule 3, use the larger dimension, <code>2</code>.</li>
</ul>
</li>
</ul>
<p>So the common dimensions are <code>(4, 3, 2)</code>. Generally, once you internalize the rules enough, it’s easier to write them compactly as:</p>
<pre><code>(1, 3,  ) | a
(4, 1, 2) | b
--------- | ------
(4, 3, 2) | common</code></pre>
<p>Here are the incremental changes made to <code>a</code> to go from <code>(1, 3)</code> to <code>(4, 3, 2)</code>.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1">a</a>
<a class="sourceLine" id="cb18-2" data-line-number="2"><span class="co">#&gt; &lt;rray&lt;int&gt;[,3][3]&gt;</span></a>
<a class="sourceLine" id="cb18-3" data-line-number="3"><span class="co">#&gt;      [,1] [,2] [,3]</span></a>
<a class="sourceLine" id="cb18-4" data-line-number="4"><span class="co">#&gt; [1,]    1    2    3</span></a>
<a class="sourceLine" id="cb18-5" data-line-number="5"></a>
<a class="sourceLine" id="cb18-6" data-line-number="6"><span class="kw"><a href="../reference/rray_broadcast.html">rray_broadcast</a></span>(a, <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb18-7" data-line-number="7"><span class="co">#&gt; &lt;rray&lt;int&gt;[,3,1][3]&gt;</span></a>
<a class="sourceLine" id="cb18-8" data-line-number="8"><span class="co">#&gt; , , 1</span></a>
<a class="sourceLine" id="cb18-9" data-line-number="9"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb18-10" data-line-number="10"><span class="co">#&gt;      [,1] [,2] [,3]</span></a>
<a class="sourceLine" id="cb18-11" data-line-number="11"><span class="co">#&gt; [1,]    1    2    3</span></a>
<a class="sourceLine" id="cb18-12" data-line-number="12"></a>
<a class="sourceLine" id="cb18-13" data-line-number="13"><span class="kw"><a href="../reference/rray_broadcast.html">rray_broadcast</a></span>(a, <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb18-14" data-line-number="14"><span class="co">#&gt; &lt;rray&lt;int&gt;[,3,1][12]&gt;</span></a>
<a class="sourceLine" id="cb18-15" data-line-number="15"><span class="co">#&gt; , , 1</span></a>
<a class="sourceLine" id="cb18-16" data-line-number="16"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb18-17" data-line-number="17"><span class="co">#&gt;      [,1] [,2] [,3]</span></a>
<a class="sourceLine" id="cb18-18" data-line-number="18"><span class="co">#&gt; [1,]    1    2    3</span></a>
<a class="sourceLine" id="cb18-19" data-line-number="19"><span class="co">#&gt; [2,]    1    2    3</span></a>
<a class="sourceLine" id="cb18-20" data-line-number="20"><span class="co">#&gt; [3,]    1    2    3</span></a>
<a class="sourceLine" id="cb18-21" data-line-number="21"><span class="co">#&gt; [4,]    1    2    3</span></a>
<a class="sourceLine" id="cb18-22" data-line-number="22"></a>
<a class="sourceLine" id="cb18-23" data-line-number="23"><span class="kw"><a href="../reference/rray_broadcast.html">rray_broadcast</a></span>(a, <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb18-24" data-line-number="24"><span class="co">#&gt; &lt;rray&lt;int&gt;[,3,2][24]&gt;</span></a>
<a class="sourceLine" id="cb18-25" data-line-number="25"><span class="co">#&gt; , , 1</span></a>
<a class="sourceLine" id="cb18-26" data-line-number="26"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb18-27" data-line-number="27"><span class="co">#&gt;      [,1] [,2] [,3]</span></a>
<a class="sourceLine" id="cb18-28" data-line-number="28"><span class="co">#&gt; [1,]    1    2    3</span></a>
<a class="sourceLine" id="cb18-29" data-line-number="29"><span class="co">#&gt; [2,]    1    2    3</span></a>
<a class="sourceLine" id="cb18-30" data-line-number="30"><span class="co">#&gt; [3,]    1    2    3</span></a>
<a class="sourceLine" id="cb18-31" data-line-number="31"><span class="co">#&gt; [4,]    1    2    3</span></a>
<a class="sourceLine" id="cb18-32" data-line-number="32"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb18-33" data-line-number="33"><span class="co">#&gt; , , 2</span></a>
<a class="sourceLine" id="cb18-34" data-line-number="34"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb18-35" data-line-number="35"><span class="co">#&gt;      [,1] [,2] [,3]</span></a>
<a class="sourceLine" id="cb18-36" data-line-number="36"><span class="co">#&gt; [1,]    1    2    3</span></a>
<a class="sourceLine" id="cb18-37" data-line-number="37"><span class="co">#&gt; [2,]    1    2    3</span></a>
<a class="sourceLine" id="cb18-38" data-line-number="38"><span class="co">#&gt; [3,]    1    2    3</span></a>
<a class="sourceLine" id="cb18-39" data-line-number="39"><span class="co">#&gt; [4,]    1    2    3</span></a></code></pre></div>
<p>And here are the changes made to <code>b</code> to go from <code>(4, 1, 2)</code> to <code>(4, 3, 2)</code>.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1">b</a>
<a class="sourceLine" id="cb19-2" data-line-number="2"><span class="co">#&gt; &lt;rray&lt;int&gt;[,1,2][8]&gt;</span></a>
<a class="sourceLine" id="cb19-3" data-line-number="3"><span class="co">#&gt; , , 1</span></a>
<a class="sourceLine" id="cb19-4" data-line-number="4"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb19-5" data-line-number="5"><span class="co">#&gt;      [,1]</span></a>
<a class="sourceLine" id="cb19-6" data-line-number="6"><span class="co">#&gt; [1,]    1</span></a>
<a class="sourceLine" id="cb19-7" data-line-number="7"><span class="co">#&gt; [2,]    2</span></a>
<a class="sourceLine" id="cb19-8" data-line-number="8"><span class="co">#&gt; [3,]    3</span></a>
<a class="sourceLine" id="cb19-9" data-line-number="9"><span class="co">#&gt; [4,]    4</span></a>
<a class="sourceLine" id="cb19-10" data-line-number="10"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb19-11" data-line-number="11"><span class="co">#&gt; , , 2</span></a>
<a class="sourceLine" id="cb19-12" data-line-number="12"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb19-13" data-line-number="13"><span class="co">#&gt;      [,1]</span></a>
<a class="sourceLine" id="cb19-14" data-line-number="14"><span class="co">#&gt; [1,]    5</span></a>
<a class="sourceLine" id="cb19-15" data-line-number="15"><span class="co">#&gt; [2,]    6</span></a>
<a class="sourceLine" id="cb19-16" data-line-number="16"><span class="co">#&gt; [3,]    7</span></a>
<a class="sourceLine" id="cb19-17" data-line-number="17"><span class="co">#&gt; [4,]    8</span></a>
<a class="sourceLine" id="cb19-18" data-line-number="18"></a>
<a class="sourceLine" id="cb19-19" data-line-number="19"><span class="kw"><a href="../reference/rray_broadcast.html">rray_broadcast</a></span>(b, <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb19-20" data-line-number="20"><span class="co">#&gt; &lt;rray&lt;int&gt;[,3,2][24]&gt;</span></a>
<a class="sourceLine" id="cb19-21" data-line-number="21"><span class="co">#&gt; , , 1</span></a>
<a class="sourceLine" id="cb19-22" data-line-number="22"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb19-23" data-line-number="23"><span class="co">#&gt;      [,1] [,2] [,3]</span></a>
<a class="sourceLine" id="cb19-24" data-line-number="24"><span class="co">#&gt; [1,]    1    1    1</span></a>
<a class="sourceLine" id="cb19-25" data-line-number="25"><span class="co">#&gt; [2,]    2    2    2</span></a>
<a class="sourceLine" id="cb19-26" data-line-number="26"><span class="co">#&gt; [3,]    3    3    3</span></a>
<a class="sourceLine" id="cb19-27" data-line-number="27"><span class="co">#&gt; [4,]    4    4    4</span></a>
<a class="sourceLine" id="cb19-28" data-line-number="28"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb19-29" data-line-number="29"><span class="co">#&gt; , , 2</span></a>
<a class="sourceLine" id="cb19-30" data-line-number="30"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb19-31" data-line-number="31"><span class="co">#&gt;      [,1] [,2] [,3]</span></a>
<a class="sourceLine" id="cb19-32" data-line-number="32"><span class="co">#&gt; [1,]    5    5    5</span></a>
<a class="sourceLine" id="cb19-33" data-line-number="33"><span class="co">#&gt; [2,]    6    6    6</span></a>
<a class="sourceLine" id="cb19-34" data-line-number="34"><span class="co">#&gt; [3,]    7    7    7</span></a>
<a class="sourceLine" id="cb19-35" data-line-number="35"><span class="co">#&gt; [4,]    8    8    8</span></a></code></pre></div>
</div>
<div id="addendum" class="section level2">
<h2 class="hasAnchor">
<a href="#addendum" class="anchor"></a>Addendum</h2>
<div id="base-r-exceptions" class="section level3">
<h3 class="hasAnchor">
<a href="#base-r-exceptions" class="anchor"></a>Base R Exceptions</h3>
<p>The only exception to the strict behavior of base R is when an array is combined with a vector. “Scalar” operations work as one might expect:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1">x</a>
<a class="sourceLine" id="cb20-2" data-line-number="2"><span class="co">#&gt;      [,1] [,2]</span></a>
<a class="sourceLine" id="cb20-3" data-line-number="3"><span class="co">#&gt; [1,]    1    2</span></a>
<a class="sourceLine" id="cb20-4" data-line-number="4"><span class="co">#&gt; [2,]    1    2</span></a>
<a class="sourceLine" id="cb20-5" data-line-number="5"><span class="co">#&gt; [3,]    1    2</span></a>
<a class="sourceLine" id="cb20-6" data-line-number="6"></a>
<a class="sourceLine" id="cb20-7" data-line-number="7">x <span class="op">*</span><span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb20-8" data-line-number="8"><span class="co">#&gt;      [,1] [,2]</span></a>
<a class="sourceLine" id="cb20-9" data-line-number="9"><span class="co">#&gt; [1,]    2    4</span></a>
<a class="sourceLine" id="cb20-10" data-line-number="10"><span class="co">#&gt; [2,]    2    4</span></a>
<a class="sourceLine" id="cb20-11" data-line-number="11"><span class="co">#&gt; [3,]    2    4</span></a></code></pre></div>
<p>But when a vector and an array are combined, the vector is recycled along the rows of the array as necessary to fit the dimensions of the array.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1">vec_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb21-2" data-line-number="2"></a>
<a class="sourceLine" id="cb21-3" data-line-number="3">x</a>
<a class="sourceLine" id="cb21-4" data-line-number="4"><span class="co">#&gt;      [,1] [,2]</span></a>
<a class="sourceLine" id="cb21-5" data-line-number="5"><span class="co">#&gt; [1,]    1    2</span></a>
<a class="sourceLine" id="cb21-6" data-line-number="6"><span class="co">#&gt; [2,]    1    2</span></a>
<a class="sourceLine" id="cb21-7" data-line-number="7"><span class="co">#&gt; [3,]    1    2</span></a>
<a class="sourceLine" id="cb21-8" data-line-number="8"></a>
<a class="sourceLine" id="cb21-9" data-line-number="9">x <span class="op">+</span><span class="st"> </span>vec_<span class="dv">1</span></a>
<a class="sourceLine" id="cb21-10" data-line-number="10"><span class="co">#&gt;      [,1] [,2]</span></a>
<a class="sourceLine" id="cb21-11" data-line-number="11"><span class="co">#&gt; [1,]    2    3</span></a>
<a class="sourceLine" id="cb21-12" data-line-number="12"><span class="co">#&gt; [2,]    3    4</span></a>
<a class="sourceLine" id="cb21-13" data-line-number="13"><span class="co">#&gt; [3,]    4    5</span></a></code></pre></div>
<p>This example seems intuitive, but even <em>partial recycling</em> is allowed, which can be quite confusing and dangerous.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1">vec_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>, <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb22-2" data-line-number="2"></a>
<a class="sourceLine" id="cb22-3" data-line-number="3">x <span class="op">+</span><span class="st"> </span>vec_<span class="dv">2</span></a>
<a class="sourceLine" id="cb22-4" data-line-number="4"><span class="co">#&gt;      [,1] [,2]</span></a>
<a class="sourceLine" id="cb22-5" data-line-number="5"><span class="co">#&gt; [1,]    2    4</span></a>
<a class="sourceLine" id="cb22-6" data-line-number="6"><span class="co">#&gt; [2,]    3    3</span></a>
<a class="sourceLine" id="cb22-7" data-line-number="7"><span class="co">#&gt; [3,]    2    4</span></a></code></pre></div>
<p>This is confusingly identical to the following, where <code>vec_2</code> is repeated to construct something that can be added to <code>x</code>.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" data-line-number="1">recycled &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/matrix">matrix</a></span>(<span class="ot">NA</span>, <span class="dv">3</span>, <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb23-2" data-line-number="2"></a>
<a class="sourceLine" id="cb23-3" data-line-number="3">recycled[<span class="dv">1</span>, <span class="dv">1</span>] &lt;-<span class="st"> </span>vec_<span class="dv">2</span>[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb23-4" data-line-number="4">recycled[<span class="dv">2</span>, <span class="dv">1</span>] &lt;-<span class="st"> </span>vec_<span class="dv">2</span>[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb23-5" data-line-number="5">recycled[<span class="dv">3</span>, <span class="dv">1</span>] &lt;-<span class="st"> </span>vec_<span class="dv">2</span>[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb23-6" data-line-number="6">recycled[<span class="dv">1</span>, <span class="dv">2</span>] &lt;-<span class="st"> </span>vec_<span class="dv">2</span>[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb23-7" data-line-number="7">recycled[<span class="dv">2</span>, <span class="dv">2</span>] &lt;-<span class="st"> </span>vec_<span class="dv">2</span>[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb23-8" data-line-number="8">recycled[<span class="dv">3</span>, <span class="dv">2</span>] &lt;-<span class="st"> </span>vec_<span class="dv">2</span>[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb23-9" data-line-number="9"></a>
<a class="sourceLine" id="cb23-10" data-line-number="10">recycled</a>
<a class="sourceLine" id="cb23-11" data-line-number="11"><span class="co">#&gt;      [,1] [,2]</span></a>
<a class="sourceLine" id="cb23-12" data-line-number="12"><span class="co">#&gt; [1,]    1    2</span></a>
<a class="sourceLine" id="cb23-13" data-line-number="13"><span class="co">#&gt; [2,]    2    1</span></a>
<a class="sourceLine" id="cb23-14" data-line-number="14"><span class="co">#&gt; [3,]    1    2</span></a>
<a class="sourceLine" id="cb23-15" data-line-number="15"></a>
<a class="sourceLine" id="cb23-16" data-line-number="16">x <span class="op">+</span><span class="st"> </span>recycled</a>
<a class="sourceLine" id="cb23-17" data-line-number="17"><span class="co">#&gt;      [,1] [,2]</span></a>
<a class="sourceLine" id="cb23-18" data-line-number="18"><span class="co">#&gt; [1,]    2    4</span></a>
<a class="sourceLine" id="cb23-19" data-line-number="19"><span class="co">#&gt; [2,]    3    3</span></a>
<a class="sourceLine" id="cb23-20" data-line-number="20"><span class="co">#&gt; [3,]    2    4</span></a></code></pre></div>
<p>rray never performs partial recycling when broadcasting, and will complain that the lengths are incorrect.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" data-line-number="1">x_rray</a>
<a class="sourceLine" id="cb24-2" data-line-number="2"><span class="co">#&gt; &lt;rray&lt;int&gt;[,2][6]&gt;</span></a>
<a class="sourceLine" id="cb24-3" data-line-number="3"><span class="co">#&gt;      [,1] [,2]</span></a>
<a class="sourceLine" id="cb24-4" data-line-number="4"><span class="co">#&gt; [1,]    1    2</span></a>
<a class="sourceLine" id="cb24-5" data-line-number="5"><span class="co">#&gt; [2,]    1    2</span></a>
<a class="sourceLine" id="cb24-6" data-line-number="6"><span class="co">#&gt; [3,]    1    2</span></a>
<a class="sourceLine" id="cb24-7" data-line-number="7"></a>
<a class="sourceLine" id="cb24-8" data-line-number="8">x_rray <span class="op">+</span><span class="st"> </span>vec_<span class="dv">2</span></a>
<a class="sourceLine" id="cb24-9" data-line-number="9"><span class="co">#&gt; Error: Non-broadcastable dimensions: (3, 2) and (2).</span></a></code></pre></div>
</div>
<div id="differences-from-python" class="section level3">
<h3 class="hasAnchor">
<a href="#differences-from-python" class="anchor"></a>Differences from Python</h3>
<p>In the Python world, numpy is used for broadcasting operations. The underlying C++ library used for rray is heavily based on the numpy principles. However, one interesting thing to note is that when applying broadcasting rules for numpy, implicit dimensions are <em>prepended to the left hand side</em> as <code>1</code>s. This is used consistently in the numpy world, even down to how they are printed. However, R often uses the concept of appended implicit dimensions the right hand side, and prints with this concept in mind.</p>
<p>For one simple example, coercing a vector to a matrix does this:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" data-line-number="1">z</a>
<a class="sourceLine" id="cb25-2" data-line-number="2"><span class="co">#&gt; [1] 1 1 1</span></a>
<a class="sourceLine" id="cb25-3" data-line-number="3"></a>
<a class="sourceLine" id="cb25-4" data-line-number="4"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/matrix">as.matrix</a></span>(z)</a>
<a class="sourceLine" id="cb25-5" data-line-number="5"><span class="co">#&gt;      [,1]</span></a>
<a class="sourceLine" id="cb25-6" data-line-number="6"><span class="co">#&gt; [1,]    1</span></a>
<a class="sourceLine" id="cb25-7" data-line-number="7"><span class="co">#&gt; [2,]    1</span></a>
<a class="sourceLine" id="cb25-8" data-line-number="8"><span class="co">#&gt; [3,]    1</span></a></code></pre></div>
<p>Meaning the dimensions went from <code>(3)</code> to <code>(3, 1)</code>. numpy actually does the opposite, and would convert <code>(3)</code> to <code>(1, 3)</code>. This is fine, because they use it consistently there, but can be confusing when comparing broadcasting of rray to numpy, and is just something to keep in mind.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#introduction">Introduction</a></li>
      <li><a href="#motivation">Motivation</a></li>
      <li><a href="#rules">Rules</a></li>
      <li><a href="#example---x-y">Example - <code>x + y</code></a></li>
      <li><a href="#example---implicit-dimensions">Example - Implicit Dimensions</a></li>
      <li><a href="#example---higher-dimensions">Example - Higher Dimensions</a></li>
      <li><a href="#addendum">Addendum</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Davis Vaughan.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
